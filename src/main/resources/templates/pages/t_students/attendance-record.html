<!DOCTYPE html>
<html
        lang="en"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layouts/student-layout}"
        xmlns:th="http://www.thymeleaf.org"
>
<head>
    <div layout:fragment="static-files">
        <style>
            .chart-legend {
                padding-left: 0;
                list-style: none;
                margin: 10px 0;
            }
            .chart-legend li {
                margin-bottom: 5px;
            }
        </style>
        <script th:src="@{/js/attendanceRecord.js}"></script>
    </div>
    <title layout:fragment="title">View My Attendance</title>
</head>
<body>

<main layout:fragment="content">
        <div class="container mt-4">
            <div class="card box-shadow-grey">
                <h4 class="card-title titlecss"><i class="fa fa-list">  My Attendance</i></h4>
                <hr>
                <div class="card-body">
                    <p>Select the subject to view the Attendance</p>
                    <div class="row align-items-end">
                        <div class="col-sm-12 col-md-4">
                            <label for="subjectcode">Select Subject:</label>
                            <select id="subjectcode" class="form-control">
                                <option value="-1">Select Subject</option>
                                <!-- Populated by Thymeleaf -->
                                <option th:each="i : ${sublist}" th:value="${i[1]}" th:text="${i[0]}"></option>
                            </select>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label for="month">Select Month:</label>
                            <select id="month" class="form-control">
                                <option value="">Select Month</option>
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <button type="button" class="btn btn-success mt-3" id="viewattendance">View Attendance</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- This section is hidden by default and shown via JavaScript -->
            <div class="card mt-4" style="display:none;" id="divChart">
                <div class="card-header">
                    <h6>My Attendance</h6>
                    <div class="card-tools float-sm-right">
                        <button class="btn btn-sm btn-warning" data-toggle="modal" data-target="#detailedAttendanceModal">View Detailed Attendance</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-7">
                            <div class="chart-responsive">
                                <canvas id="attendanceChart" height="150"></canvas>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <ul class="chart-legend clearfix">
                                <li><i class="fas fa-circle text-success"></i> Present (<span id="countPresent">0</span>)</li>
                                <li><i class="fas fa-circle text-danger"></i> Absent (<span id="countAbsent">0</span>)</li>
                                <li><i class="fas fa-circle text-info"></i> Total (<span id="countTotal">0</span>)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <br>

    <!-- Modal for Detailed Attendance -->
    <div class="modal fade" id="detailedAttendanceModal">
        <div class="modal-dialog modal-dialog-centered modal-xl">
            <div class="modal-content">
                <div class="modal-header text-center">
                    <h5 class="modal-title"><u>Detailed Attendance</u></h5>
                    <button type="button" class="close" data-dismiss="modal">×</button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive p-3">
                        <table class="table table-striped table-bordered" id="attendancetable" style="width:100%;">
                            <thead>
                            <tr>
                                <th>Sl. No.</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Class Timing</th>
                            </tr>
                            </thead>
                            <tbody id="atttablebody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<th:block layout:fragment="scripts">
    <script th:inline="javascript">
    </script>
</th:block>

</body>
</html>