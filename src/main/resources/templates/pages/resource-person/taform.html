<!DOCTYPE html>
<html lang="en"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
layout:decorate="~{layouts/resource-person-layout}">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <div layout:fragment="static-files">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    </div>
    <title>Local TA Form - NERIE Shillong</title>
    <style>
        .form-wrapper {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 1rem;
            position: relative;
        }
        .section-title {
            background-color: #f8f9fa;
            padding: 0.5rem 1rem;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid #198754;
            font-weight: bold;
        }
        .language-selector {
            position: relative;
            top: 20px;
            right: 150px;
            background-color: #fff;
            padding: 5px 10px;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
            z-index: 10;
        }
        .table td, .table th {
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <main layout:fragment="content">
        <div> 
            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true">Form</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">Applied</button>
                </li>
            </ul>
        </div>
        <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                <!-- Form Here-->
                <div class="form-wrapper position-relative">
                    <!-- Language Selector -->
                    <div class="language-selector position-absolute top-0 end-0 mt-3 me-4">
                        <input type="radio" id="english" name="language" value="english" checked />
                        <label for="english" class="me-2">English</label>
                        <input type="radio" id="hindi" name="language" value="hindi" />
                        <label for="hindi">हिंदी</label>
                    </div>
                </div>
                
                <!-- Form Container -->
                <div class="container bg-white shadow rounded p-4" style="max-width: 1000px;">
                    <h2 class="text-center mb-4 fw-bold text-dark">Local Travelling Allowance Bill (For Local Participants)</h2>
                    <form th:action="@{/nerie/resource-persons/taform}" th:object="${taform}" method="POST">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label en">Programme/Workshop/Seminar Title:</label>
                                <label class="form-label hi">कार्यक्रम/कार्यगोष्ठी/संगोष्ठी का नाम:</label>
                                <select class="form-control" th:field="*{phase.phaseid}">
                                    <option value="">-- Select --</option>
                                    <option th:each="program : ${programData}" th:value="${program[7]}" th:text="${program[2]}"></option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label en">Venue:</label> 
                                <label class="form-label hi">स्थान:</label>
                                <input type="text"  class="form-control" th:field="*{venue}"/>
                            </div>
                        </div>
                        <div class="col">
                            <label class="form-label en">Dates: From</label>
                            <label class="form-label hi">दिनांक: से</label>
                            <input type="date" class="form-control" th:field="*{fromdate}">
                        </div>
                        <div class="col">
                            <label class="form-label en">To</label>
                            <label class="form-label hi">तक</label>
                            <input type="date" class="form-control" th:field="*{todate}">
                        </div>
                        
                        
                        <div class="mb-3">
                            <label class="form-label en">Name (as per Bank records in CAPITAL):</label>
                            <label class="form-label hi">नाम (बैंक रिकॉर्ड अनुसार):</label>
                            <!-- th:field="*{namerecord}" -->
                            <input type="text" name="namerecord" class="form-control" > 
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col">
                                <label class="form-label en">Designation:</label>
                                <label class="form-label hi">पदनाम:</label>
                                <!-- th:field="*{designation}" -->
                                <input type="text" name="designation" class="form-control" >
                            </div>
                            <div class="col">
                                <label class="form-label en">Basic Pay / Pay Level:</label>
                                <label class="form-label hi">मूल वेतन:</label>
                                <!-- th:field="*{basicpay}" -->
                                <input type="number" name="basicpay" class="form-control" >
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label en">Official Address:</label>
                            <label class="form-label hi">कार्यालय का पता:</label>
                            <!-- th:field="*{address}" -->
                            <textarea class="form-control" name="address" rows="2" ></textarea>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col">
                                <label>City:</label>
                                <!-- th:field="*{city}" -->
                                <input type="text" class="form-control" name="city" >
                            </div>
                            <div class="col">
                                <label>Pin Code:</label>
                                <!-- th:field="*{pincode}" -->
                                <input type="text" class="form-control" name="pincode">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label en">Residential Address:</label>
                            <label class="form-label hi">आवासीय पता:</label>
                            <!-- th:field="*{resaddress}" -->
                            <textarea class="form-control" rows="2" name="resaddress"></textarea>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col">
                                <label>City:</label>
                                <!-- th:field="*{rcity}" -->
                                <input type="text" class="form-control" name="rcity">
                            </div>
                            <div class="col">
                                <label>Pin Code:</label>
                                <!-- th:field="*{rpincode}" -->
                                <input type="text" class="form-control" name="rpincode">
                            </div>
                        </div>
                        
                        <div class="section-title">
                            <span class="en">Bank Details</span>
                            <span class="hi">बैंक विवरण</span>
                        </div>
                        
                        <div class="row mb-3">
                            <!-- th:field="*{accountnumber}" -->
                            <div class="col-md-6"><label>Account No.:</label><input type="text" class="form-control" name="accountnumber"></div>
                            <!-- th:field="*{bankname}" -->
                            <div class="col-md-6"><label>Bank:</label><input type="text" class="form-control" name="bankname"></div>
                        </div>
                        <div class="row mb-3">
                            <!-- th:field="*{branch}" -->
                            <div class="col-md-6"><label>Branch:</label><input type="text" class="form-control" name="branch"></div>
                            <!-- th:field="*{ifsc}" -->
                            <div class="col-md-6"><label>IFSC Code:</label><input type="text" class="form-control" name="ifsc"></div>
                        </div>
                        <!-- th:field="*{pancardnumber}" -->
                        <div class="mb-3"><label>PAN Card No.:</label><input type="text" class="form-control" name="pancardnumber"></div>
                        
                        <div class="section-title">
                            <span class="en">Details of Conveyance Charges</span>
                            <span class="hi">यात्रा विवरण</span>
                        </div>
                        
                        <table class="table table-bordered mb-3" id="conveyanceTable">
                            <thead class="table-light">
                                <tr>
                                    <th>Date</th>
                                    <th>Place of Departure</th>
                                    <th>Place of Arrival</th>
                                    <th>Kms</th>
                                    <th>Mode of Conveyance</th>
                                    <th>Amount (₹)</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <!-- Initial 3 rows -->
                                <tr>
                                    <td><input name="date" type="date" class="form-control" required></td>
                                    <td><input name="departure" type="text" class="form-control" required></td>
                                    <td><input name="arrival" type="text" class="form-control" required></td>
                                    <td><input name="kms" type="number" class="form-control" required></td>
                                    <td><input name="mode" type="text" class="form-control" required></td>
                                    <td><input name="amount" type="number" class="form-control" required></td>
                                </tr>
                                <tr>
                                    <td><input name="date" type="date" class="form-control" required></td>
                                    <td><input name="departure" type="text" class="form-control" required></td>
                                    <td><input name="arrival" type="text" class="form-control" required></td>
                                    <td><input name="kms" type="number" class="form-control" required></td>
                                    <td><input name="mode" type="text" class="form-control" required></td>
                                    <td><input name="amount" type="number" class="form-control" required></td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="mb-3">
                            <button type="button" id="addRowBtn" class="btn btn-primary">Add Row</button>
                        </div>
                        
                        <script>
                            const maxRows = 10;
                            let rowCount = 2;
                            
                            document.getElementById("addRowBtn").addEventListener("click", () => {
                                if (rowCount >= maxRows) return;
                                
                                const tbody = document.getElementById("tableBody");
                                const row = document.createElement("tr");
                                row.innerHTML = `
                            <td><input name="date" type="date" class="form-control" required></td>
                            <td><input name="departure" type="text" class="form-control" required></td>
                            <td><input name="arrival" type="text" class="form-control" required></td>
                            <td><input name="kms" type="number" class="form-control" required></td>
                            <td><input name="mode" type="text" class="form-control" required></td>
                            <td><input name="amount" type="number" class="form-control" required></td>
                            <td><button type="button" class="btn btn-danger btn-sm deleteRowBtnP2">Delete</button></td>
                            `;
                                tbody.appendChild(row);
                                rowCount++;

                                // Attach delete event to this row's delete button
                        row.querySelector(".deleteRowBtnP2").addEventListener("click", () => {
                            row.remove();
                            rowCount--;
                        });
                            });
                        </script>
                        <div class="mt-4">
                            <button type="submit" class="btn btn-success w-100">
                                <span class="en">Submit</span>
                                <span class="hi">जमा करें</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                <h3 class="mb-4">TA Forms List</h3>
                
                <table class="table table-bordered table-striped align-middle">
                    <thead class="table-dark">
                        <tr>
                            <th>Program</th>
                            <th>Venue</th>
                            <th>From Date</th>
                            <th>To Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="form : ${TaForms}">
                            <td th:text="${form.program}">Program Name</td>
                            <td th:text="${form.venue}">Venue Name</td>
                            <td th:text="${#temporals.format(form.fromdate, 'dd-MM-yyyy')}">01-01-2025</td>
                            <td th:text="${#temporals.format(form.todate, 'dd-MM-yyyy')}">03-01-2025</td>
                            <td>
                                <a th:href="@{/nerie/resource-persons/taformdetails/{id}(id=${form.id})}" target="_blank">
                                    <button class="btn btn-primary">View Details</button>
                                </a>
                            </td>
                        </tr>
                        <tr th:if="${#lists.isEmpty(TaForms)}">
                            <td colspan="4" class="text-center text-muted">No TA Forms found.</td>
                        </tr>
                    </tbody>
                </table>
            </div>           
        </div>
    </div>
    
    <script nonce="${cspNonce}">
        function changeLanguage() {
            const language = document.querySelector('input[name="language"]:checked').value;
            document.querySelectorAll('.en').forEach(el => el.style.display = language === 'hindi' ? 'none' : 'block');
            document.querySelectorAll('.hi').forEach(el => el.style.display = language === 'hindi' ? 'block' : 'none');
        }
        
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById("english").addEventListener("change", changeLanguage);
            document.getElementById("hindi").addEventListener("change", changeLanguage);
            changeLanguage();
        });
    </script>
</main>
</body>
</html>